<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetLife - Relatórios</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

        <!-- Sidebar / Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <i class="fa-solid fa-paw"></i>
                <span>PetLife</span>
            </div>
            <ul class="nav-links">
                <li><a href="dashboard.html"><i class="fa-solid fa-house"></i> Dashboard</a></li>
                <li><a href="packages.html"><i class="fa-solid fa-box-open"></i> Pacotes</a></li>
                <li><a href="expenses.html"><i class="fa-solid fa-wallet"></i> Despesas</a></li>
                <li><a href="bills-overview.html"><i class="fa-solid fa-file-invoice-dollar"></i> Contas a Pagar</a>
                </li>
                <li class="active"><a href="reports.html"><i class="fa-solid fa-chart-line"></i> Relatórios</a></li>
            </ul>
            <div class="sidebar-footer">
                <button class="btn-logout" onclick="logout()">
                    <i class="fa-solid fa-right-from-bracket"></i> Sair
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header>
                <div style="display:flex; align-items:center;">
                    <button class="mobile-menu-btn" onclick="toggleSidebar()">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <div>
                        <h1>Relatórios Financeiros</h1>
                        <p class="subtitle">Visualize o histórico e detalhes das vendas.</p>
                    </div>
                </div>
            </header>

            <!-- Filters -->
            <section class="filters-section">
                <div class="glass-panel filters-panel">
                    <div class="filter-group">
                        <label>MÊS</label>
                        <select id="filter-month" class="input-field">
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>DIA <small>(Opcional)</small></label>
                        <select id="filter-day" class="input-field">
                            <option value="">Todos</option>
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>ANO</label>
                        <select id="filter-year" class="input-field">
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <button id="btn-filter" class="btn-secondary">
                        <i class="fa-solid fa-filter"></i> Filtrar
                    </button>
                </div>
            </section>

            <!-- Summary Cards for Report -->
            <section class="dashboard-cards small-cards"
                style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <div class="card card-report-month">
                    <div class="card-info">
                        <h3>Total Geral</h3>
                        <p class="amount" id="report-month-total" style="color: var(--primary-color);">R$ 0,00</p>
                    </div>
                    <div class="card-icon"><i class="fa-solid fa-cash-register"></i></div>
                </div>
                <!-- Breakdown Cards -->
                <div class="card" style="border-left: 4px solid #22c55e;">
                    <div class="card-info">
                        <h3 style="font-size: 0.9rem; color: #64748b;">Dinheiro</h3>
                        <p class="amount" id="report-total-money" style="font-size: 1.5rem;">R$ 0,00</p>
                    </div>
                    <div class="card-icon" style="background:#dcfce7; color:#22c55e;"><i
                            class="fa-solid fa-money-bill-wave"></i></div>
                </div>
                <div class="card" style="border-left: 4px solid #3b82f6;">
                    <div class="card-info">
                        <h3 style="font-size: 0.9rem; color: #64748b;">Pix</h3>
                        <p class="amount" id="report-total-pix" style="font-size: 1.5rem;">R$ 0,00</p>
                    </div>
                    <div class="card-icon" style="background:#dbeafe; color:#3b82f6;"><i class="fa-brands fa-pix"></i>
                    </div>
                </div>
                <div class="card" style="border-left: 4px solid #f59e0b;">
                    <div class="card-info">
                        <h3 style="font-size: 0.9rem; color: #64748b;">Débito</h3>
                        <p class="amount" id="report-total-debit" style="font-size: 1.5rem;">R$ 0,00</p>
                    </div>
                    <div class="card-icon" style="background:#fef3c7; color:#f59e0b;"><i
                            class="fa-solid fa-credit-card"></i></div>
                </div>
                <div class="card" style="border-left: 4px solid #8b5cf6;">
                    <div class="card-info">
                        <h3 style="font-size: 0.9rem; color: #64748b;">Crédito</h3>
                        <p class="amount" id="report-total-credit" style="font-size: 1.5rem;">R$ 0,00</p>
                    </div>
                    <div class="card-icon" style="background:#ede9fe; color:#8b5cf6;"><i
                            class="fa-solid fa-credit-card"></i></div>
                </div>
            </section>

            <!-- Detailed List & Weekly Summary -->
            <div class="content-grid reports-grid">
                <!-- Daily List -->
                <section class="report-list-section">
                    <div class="glass-panel">
                        <h2><i class="fa-solid fa-list"></i> Detalhes do Mês</h2>
                        <div class="table-container">
                            <table class="sales-table">
                                <thead>
                                    <tr>
                                        <th>Data</th>
                                        <th>Dia da Semana</th>
                                        <th>Dinheiro</th>
                                        <th>Pix</th>
                                        <th>Débito</th>
                                        <th>Crédito</th>
                                        <th>Total (R$)</th>
                                        <th>Obs</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="sales-table-body">
                                    <!-- Rows injected by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Weekly Summary -->
                <section class="weekly-summary-section">
                    <div class="glass-panel">
                        <h2><i class="fa-solid fa-calendar-week"></i> Resumo Semanal</h2>
                        <ul class="weekly-list" id="weekly-list">
                            <!-- Injected by JS -->
                        </ul>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Edit Modal (Simplified for specific total edit, or could be expanded in v2) -->
    <!-- For now disabling complex edit in modal to keep it simple, user can edit via Dashboard for specific day -->
    <div id="edit-modal" class="modal">
        <div class="modal-content glass-panel">
            <span class="close-modal">&times;</span>
            <h2>Atenção</h2>
            <p>Para editar os valores detalhados, por favor vá ao Dashboard, selecione a data e altere os valores no
                formulário principal.</p>
            <div class="modal-actions" style="margin-top: 1rem;">
                <button type="button" class="btn-primary" onclick="window.location.href='index.html'">Ir para
                    Dashboard</button>
                <button type="button" class="btn-danger" id="btn-delete-sale">Excluir Venda</button>
            </div>
            <!-- Hidden inputs for delete logic to work -->
            <input type="hidden" id="edit-id">
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fa-solid fa-trash-can"></i>
            </div>
            <h2>Excluir Lançamento?</h2>
            <p>Essa ação removerá permanentemente o registro de venda. Você tem certeza que deseja continuar?</p>
            <input type="hidden" id="delete-target-id">
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeDeleteModal()">Cancelar</button>
                <button type="button" class="btn-danger" onclick="confirmDelete()">Excluir Agora</button>
            </div>
        </div>
    </div>

    <!-- Observation View Modal -->
    <div id="observation-modal" class="modal">
        <div class="modal-content">
            <div class="modal-icon" style="background:#e0f2fe; color:#0ea5e9;">
                <i class="fa-regular fa-comment-alt"></i>
            </div>
            <h2>Observação</h2>
            <div id="observation-text"
                style="background:#f8fafc; padding:1.5rem; border-radius:12px; margin-bottom:2rem; color:#475569; font-style:italic; text-align:left; border:1px solid #e2e8f0;">
                <!-- Text injected here -->
            </div>
            <div class="modal-actions" style="grid-template-columns: 1fr;">
                <button type="button" class="btn-secondary" onclick="closeObservationModal()">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast"></div>
    <!-- Logout Modal -->
    <div id="logout-modal" class="modal">
        <div class="logout-modal-content modal-content">
            <div class="logout-icon">
                <i class="fa-solid fa-right-from-bracket"></i>
            </div>
            <h2>Sair do Sistema?</h2>
            <p>Você será desconectado e precisará fazer login novamente para acessar o sistema.</p>
            <div class="logout-actions">
                <button type="button" class="btn-cancel-logout" onclick="cancelLogout()">
                    Cancelar
                </button>
                <button type="button" class="btn-confirm-logout" id="btn-confirm-logout" onclick="confirmLogout()">
                    <i class="fa-solid fa-right-from-bracket"></i> Sair
                </button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <!-- Logout Modal -->
    <div id="logout-modal" class="modal">
        <div class="logout-modal-content modal-content">
            <div class="logout-icon">
                <i class="fa-solid fa-right-from-bracket"></i>
            </div>
            <h2>Sair do Sistema?</h2>
            <p>Você será desconectado e precisará fazer login novamente para acessar o sistema.</p>
            <div class="logout-actions">
                <button type="button" class="btn-cancel-logout" onclick="cancelLogout()">
                    Cancelar
                </button>
                <button type="button" class="btn-confirm-logout" id="btn-confirm-logout" onclick="confirmLogout()">
                    <i class="fa-solid fa-right-from-bracket"></i> Sair
                </button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>

</html>